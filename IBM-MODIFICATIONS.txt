Security Vulnerability Patch for Exploiting Intents

- Cordova RTC work item number: 75631
- Apache Cordova Jira issue: 
- Markmail / Google Group / StackOverflow reference:
- IBM PMR: 9X999,999,000
- Worklight RTC work item number: (APAR) 75615
- CVE-2015-1835: Remote exploit of secondary configuration variables in Apache Cordova on Android
- Full description: Unwanted users are able to use intents to start an application 
and modify the config.xml with preferences that the developer did not specify. The 
intent injects the preference tag with a name and value into the config.xml so the 
unwanted user is able to start and exploit the application remotely. The vulnerability 
is limited to injecting the preference tag, but it is still exploiting the application 
nonetheless. The fix for this is to remove the intent functionality. No one will be 
able to use intents to start their app or inject preferences. 

Apply security fixes for cordova-android vulnerabilities

- RTC work item number: 45720
- Apache Cordova Jira issue: 
- Markmail or Google Group reference:
- Product PMR:
- Description: Severe remote exploitation vulnerabilities were discovered in 
Cordova-android. These were filed as CVE-2014-3500 (Cross-application scripting
via Android intent URLs), CVE-2014-3501 (Cordova whitelist bypass for non-http URLs)
and CVE-2014-3502 (Cordova apps can potentially leak data to other apps via android intent URLs.)
Because this stream is so out of date, we chose to apply as many security fixes as possible knowing
that most would not be a one-to-one backport but instead a manual copy of the functionality. 
For CVE 3500, we were able to remove the ability to set the startURL and errorURL from an Intent.
Now, the startURL will always be file:///android_asset/www/index.html - it cannot be customized. The 
errorUrl is not used and a dialog is instead shown if there is an error page.
For CVE 3501, we make sure to add the CATEGORY_BROWSABLE to any intents not explicitly handled by
the Cordova code (like sms:, mailto:, etc.,) so that these intents can only be opened by a browser.
For CVE 3502 we block access to "app_webview" folder that contains cookies, SQLite databases, and other
potentially sensitive data. 